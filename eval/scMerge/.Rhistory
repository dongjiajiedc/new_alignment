setwd('/Users/dongjiajie/Desktop/alignment/fyp/hyperalignment/scMerge')
suppressPackageStartupMessages({
library(SingleCellExperiment)
library(scMerge)
library(scater)
library(zellkonverter)

})



adata <- readH5AD('./data12.h5ad')

adata@assays@data@listData[["counts"]] <- array(as.vector(adata@assays@data@listData[["X"]]), dim = dim(adata@assays@data@listData[["X"]]))

adata@assays@data@listData[["logcounts"]] <- array(as.vector(adata@assays@data@listData[["X"]]), dim = dim(adata@assays@data@listData[["X"]]))

scMerge_unsupervised <- scMerge(
  sce_combine = adata, 
  ctl = result
  kmeansK =  c(3,3),
  assay_name = "scMerge_unsupervised")